<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="github-ajax">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <iron-ajax auto
      url="https://api.github.com/repos/[[owner]]/[[repo]]/git/refs/heads/[[branch]]"
      handle-as="json"
      last-response="{{ref}}">
    </iron-ajax>
    <iron-ajax id="treeAjax"
      url="https://api.github.com/repos/[[owner]]/[[repo]]/contents/[[baseDir]]"
      params='{"ref": [[branch]]}'
      handle-as="json"
      last-response="{{tree}}">
    </iron-ajax>
  </template>
  <script>
    Polymer({
      is: 'github-ajax',

      properties: {
        ref: {
          type: Object,
          observer: '_processRefResp'
        },
        tree: {
          type: Object,
          observer: '_processTree'
        }
      },
      _processRefResp(ref) {
        console.log(ref);
        console.log(ref.object.sha);
        this.sha = ref.object.sha;
        this.$.treeAjax.generateRequest();
      },
      _processTree(tree) {
        console.log(tree);
      }


    });
  </script>
</dom-module>
