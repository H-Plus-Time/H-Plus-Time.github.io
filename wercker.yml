box: markadams/chromium-xvfb-js
build:
  steps:
    - npm-install
    - script:
        name: bower install
        code: |
          ./node_modules/bower/bin/bower install --allow-root --config.interactive=false
    - script:
        name: gulp install
        code: |
          npm install -g gulp-cli && gulp
    - script:
        name: npm test
        code: |
          xvfb-run npm test
deploy:
  steps:
    - script:
        name: clone posts
        code: |
          cd build/bundled
          rm -r blog
          git clone git@github.com:H-Plus-Time/blog.git && rm -r blog/.git
          ls blog
          cd ../..
    - leipert/git-push:
        branch: master
        gh_oauth: $GITHUB_TOKEN
        basedir: build/bundled
